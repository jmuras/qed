# Instalacja

Żeby uruchomić aplicację może skorzystać z pliku ./install.sh . Tworzy on wirtualne środowisko i instaluje potrzebne pakiety (plik requirements.txt)


# Uruchomienie

## Development

Uruchomienie na domyslnym serwerze - ./run_developlemnt.sh

## Produkcja

Uruchomienie na serwerze Gunicorn - ./run_production.sh


# Uruchomienie

Serwis został uruchomiony na pod następującym adresem:

http://jmuras.com:5000/


# Serwis dostarcza następujące endpointy:

## 1. POST /train/{l}?k={k}

  * l - ilość części na które należy podzielić zbiór 
  * k - liczba najbliższych obiektów dla których należy policzyć reprezentatywność (opcjonalnie)
	
	
### Przykładowe zapytanie:
URL
```
http://127.0.0.1:5000/train/30
```
Body
```	
[[4.8,6.5,2.6],[2.2,4.5,6.8],[2.7,7.4,3.8],[2.1,8.1,1],[7.7,9,6],[4.4,8.6,3.3],[3,7.6,5.9],[1.8,9.8,3.7],[4.1,7.7,6.1],[8.7,1.6,5.9],[1.2,2,5.5],[6.8,4.1,5.5],[6.7,4.2,6.2],[2.7,4.4,8.4],[7.3,5.7,9.8],[9.3,7.3,3.7],[7.3,6.8,5.4],[5.6,3.4,3.1],[1.1,4.4,4.5],[1.8,1.8,7.5],[7,5.9,4.2],[5.4,2.3,3],[3,1.9,5.6],[4.3,9.1,8.7],[2.5,5.5,3.4],[3.1,9.4,1.4],[4.6,4.4,10],[8.7,8.9,2.9],[3.3,7.2,9.5],[9.9,2,4.2],[8.2,1.9,9.9],[7.5,6.8,6.6],[4.9,8.7,5.7],[1.8,9.2,7.2],[8.1,2.8,3.4],[1.5,9.9,6.5],[8.4,1.4,9.2],[7.8,7.3,3.8],[4.9,6.6,2.7],[9.9,10,3.5],[5,8,3],[8.2,8.1,7.8],[5,4.5,4.3],[5.7,6.2,4.9],[2.5,2.4,7.6],[5.1,1.3,7.9],[8.4,4.7,1.1],[3.4,2.9,1.4],[9.9,5.2,4.8],[9.5,4.5,6],[7.7,6.7,9.2],[8.2,5.2,7.6],[7.2,6.6,10],[6,2.9,1],[8.8,3.4,3.2],[4.2,5.3,8.2],[9.3,3,8.3],[5.7,3.9,1.9],[7.3,5.8,1.8],[1.9,9.1,8.3],[4.4,4.5,8.2],[5.1,7.6,3.2],[6.8,1.7,2.2],[1.7,1,4.6],[6.4,3.7,5.8],[9.1,5.3,3.7],[5.7,1.2,1.4],[2.4,4.4,5.5],[7.3,5.2,6.2],[8.7,6.3,5.1],[2.9,9.5,5.6],[1.6,8.8,4],[1.1,7.7,2.8],[9.4,4.5,4.1],[6.7,8,4.3],[9.4,9.2,3.3],[9.7,7,5.6],[6,4.8,5.6],[5.9,8.2,2],[4.6,8.2,4.4],[5.7,1.3,3.4],[6.9,2.2,8.3],[2.6,6.4,3.7],[4.3,4.4,2.9],[7.4,4,9.2],[6.5,8.1,6.5],[9.8,7.2,4.7],[5.4,4.8,1],[6.8,2.3,1.1],[9.8,4.3,2.8],[6.9,9.1,4.8],[2.9,4.9,1.9],[4.7,5.3,2.8],[2.8,8.8,2.7],[2.8,1.2,8.1],[9.6,9.7,3.1],[8.1,1.1,6.8],[2.4,1.5,5.6],[1.7,2.9,7.1],[8.7,3,8.3]]
```

### Przykładowe odpowiedzi:
	
Trening zaczęty
```
{
    "status": "new"
}
```

#### Trening w trakcie
```
{
	"start_time": "2021-04-04 18:07:28.336572",
	"status": "training"
}
```

## 2. GET /status

### Przykładowe odpowiedzi:
	
Trening zakończony pomyślnie
```
{
	  "finish_time": "2021-04-04 16:42:18.970958", 
	  "start_time": "2021-04-04 16:42:08.893229", 
	  "status": "ready"
}
```
Trening w trakcie
```
	{
	  "start_time": "2021-04-04 18:07:28.336572", 
	  "status": "training"
	}
```
Trening zakończony błędami
```
	{
	  "errors": [
		{
		  "description": "timeout", 
		  "time": "2021-04-04 18:13:37.486622"
		}
	  ], 
	  "finish_time": "None", 
	  "start_time": "2021-04-04 18:13:32.416135", 
	  "status": "fault"
	}
```


## POST /predict

Body
```	
[[4.8,6.5,2.6],[2.2,4.5,6.8],[2.7,7.4,3.8],[2.1,8.1,1],[7.7,9,6],[4.4,8.6,3.3],[3,7.6,5.9],[1.8,9.8,3.7],[4.1,7.7,6.1],[8.7,1.6,5.9],[1.2,2,5.5],[6.8,4.1,5.5],[6.7,4.2,6.2],[2.7,4.4,8.4],[7.3,5.7,9.8],[9.3,7.3,3.7],[7.3,6.8,5.4],[5.6,3.4,3.1],[1.1,4.4,4.5],[1.8,1.8,7.5],[7,5.9,4.2],[5.4,2.3,3],[3,1.9,5.6],[4.3,9.1,8.7],[2.5,5.5,3.4],[3.1,9.4,1.4],[4.6,4.4,10],[8.7,8.9,2.9],[3.3,7.2,9.5],[9.9,2,4.2],[8.2,1.9,9.9],[7.5,6.8,6.6],[4.9,8.7,5.7],[1.8,9.2,7.2],[8.1,2.8,3.4],[1.5,9.9,6.5],[8.4,1.4,9.2],[7.8,7.3,3.8],[4.9,6.6,2.7],[9.9,10,3.5],[5,8,3],[8.2,8.1,7.8],[5,4.5,4.3],[5.7,6.2,4.9],[2.5,2.4,7.6],[5.1,1.3,7.9],[8.4,4.7,1.1],[3.4,2.9,1.4],[9.9,5.2,4.8],[9.5,4.5,6],[7.7,6.7,9.2],[8.2,5.2,7.6],[7.2,6.6,10],[6,2.9,1],[8.8,3.4,3.2],[4.2,5.3,8.2],[9.3,3,8.3],[5.7,3.9,1.9],[7.3,5.8,1.8],[1.9,9.1,8.3],[4.4,4.5,8.2],[5.1,7.6,3.2],[6.8,1.7,2.2],[1.7,1,4.6],[6.4,3.7,5.8],[9.1,5.3,3.7],[5.7,1.2,1.4],[2.4,4.4,5.5],[7.3,5.2,6.2],[8.7,6.3,5.1],[2.9,9.5,5.6],[1.6,8.8,4],[1.1,7.7,2.8],[9.4,4.5,4.1],[6.7,8,4.3],[9.4,9.2,3.3],[9.7,7,5.6],[6,4.8,5.6],[5.9,8.2,2],[4.6,8.2,4.4],[5.7,1.3,3.4],[6.9,2.2,8.3],[2.6,6.4,3.7],[4.3,4.4,2.9],[7.4,4,9.2],[6.5,8.1,6.5],[9.8,7.2,4.7],[5.4,4.8,1],[6.8,2.3,1.1],[9.8,4.3,2.8],[6.9,9.1,4.8],[2.9,4.9,1.9],[4.7,5.3,2.8],[2.8,8.8,2.7],[2.8,1.2,8.1],[9.6,9.7,3.1],[8.1,1.1,6.8],[2.4,1.5,5.6],[1.7,2.9,7.1],[8.7,3,8.3]]
```
Przykładowa odpowiedź:
```
[0.1581329118533916,0.1575925958550201,0.16018522862855347,0.1583127647756379,0.17774587324840863,0.1651439967712146,0.1646281463117015,0.16486717287596842,0.16760200958616805,0.1386383752638008,0.15431580698319639,0.15389166120216954,0.15561293682216223,0.1591770947238009,0.1712017308556117,0.14921788513232845,0.16200515841860524,0.15286521483140608,0.1553842615866388,0.15416182716643398,0.1561112717053562,0.15223992020827457,0.1546327423352786,0.18487898707426445,0.1565513527036509,0.16306427917832,0.16351961751059862,0.16051526706623273,0.1724123447528013,0.12527454140860175,0.14751533853380108,0.1655933725118275,0.17258697081812333,0.17037441366153294,0.1425335249803524,0.17045989734741998,0.1437011678422572,0.15812679093525095,0.15845784304549246,0.1645829755915626,0.16293734019800976,0.1790130919827629,0.1561767019348437,0.1606444097826631,0.15517938843279971,0.1535606522833067,0.14149583903948845,0.15401927502563278,0.136229513186762,0.14062989006910354,0.17555709482920828,0.157892451475573,0.17882434744945616,0.1505181258918344,0.13812033435427554,0.16357945301193105,0.14184264886369832,0.15243193458327958,0.15082261993115761,0.17341159391926894,0.16120940904410413,0.16198206085136116,0.1475453642640359,0.1540798547783762,0.15442687636269234,0.14159307376435404,0.15067379163536385,0.15670919540056394,0.15729000005923224,0.15264175913181738,0.17091044722399695,0.16196889448748256,0.15775069234033035,0.1369606423523849,0.16564543205383245,0.16006440477732042,0.15130786884567454,0.15757753678452438,0.16182282629052944,0.16622032071470513,0.15117097170575855,0.15236745945962182,0.1580892463405413,0.15523464426229736,0.15920354513306467,0.17401176850373243,0.1479678065782675,0.15345250743048883,0.14753127380054484,0.12972582398724622,0.1736946044741757,0.1553062929004234,0.15614518899092747,0.16237804402323236,0.15376065527570523,0.16203975506844828,0.1428287985043319,0.1543331476676668,0.1552323008430293,0.14651994356312345]
```

# Uwagi
* W produkcyjnym rozwiązaniu wytrenowane modele byłyby zapisaywane do plików i wczytywane przy starcie aplikacji
* W produkcyjnym rozwiązaniu użyłabym bazy danych, żeby śledzić modele zlecone do trenowania, ich czasy i zapisane pliki
* Żeby serwis był bardziej responsywny zdecydowłam się utrzymywać 2 modele - jeden wytrenowany poprawnie, żeby zwracać predykcje i drugi, który zawierał ostatnio trenowany model